# Example passport-google-one-tap

This example illustrates how to use [Express](https://expressjs.com) 4.x and
[Passport](https://www.passportjs.org) to sign users in with [Google One Tap](https://developers.google.com/identity/one-tap).
Use this example as a starting point for your own web applications.

## Quick Start

To get started with this example, clone the repository and install the
dependencies.

```bash
git clone git@github.com:Genially/passport-google-one-tap.git
cd example
npm install
```

This example requires credentials from Google, which can be obtained by
creating a project in the [Google Developers Console](https://console.developers.google.com/)
following the [Google guidelines](https://developers.google.com/identity/gsi/web/guides/get-google-api-clientid).

You must add both `http://localhost` and `http://localhost:3000` to the Authorized JavaScript origins box. The
authorized callback URL of the app should be added also: `http://localhost:3000/callback/google-one-tap`

Once credentials have been obtained, create a `.env` file and add the following
environment variables:

```txt
GOOGLE_CLIENT_ID={{INSERT_GOOGLE_CLIENT_ID_HERE}}
GOOGLE_CLIENT_SECRET={{INSERT_GOOGLE_CLIENT_SECRET_HERE}}
```

Start the server.

```bash
npm start
```

Navigate to [`http://localhost:3000`](http://localhost:3000).

## Overview

This example illustrates how to use [Passport](https://www.passportjs.org) and
the [`passport-google-one-tap`](https://www.npmjs.com/package/passport-google-one-tap)
strategy within an [Express](https://expressjs.com) application to sign users in
with [Google One Tap](https://developers.google.com/identity/one-tap).

The example builds upon the scaffolding created by [Express generator](https://expressjs.com/en/starter/generator.html),
and uses [EJS](https://ejs.co) as a view engine and plain CSS for styling. This
scaffolding was generated by executing:

```bash
express --view ejs express
```

The example uses [SQLite](https://www.sqlite.org) for storing user accounts.
SQLite is a lightweight database that works well for development, including this
example.

Added to the scaffolding are files which add authentication to the application.

- [`db.js`](db.js)

  This file initializes the database by creating the tables used to store user
  accounts and credentials.

- [`auth.js`](auth.js)

  This file configures the Google One Tap strategy and
  supplies the serialization functions used for session management.

- [`routes/auth.js`](routes/auth.js)

  This file defines the routes used for authentication.
